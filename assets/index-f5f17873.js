import{g as Z,c as M,s as ee,a as _,b as te,d as oe,e as re,f as ne,h as ae,i as le,j as ie,l as O,k,N as W}from"./shopping-list-6b839f76.js";var U="Expected a function",F=0/0,se="[object Symbol]",ce=/^\s+|\s+$/g,de=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,fe=/^0o[0-7]+$/i,ue=parseInt,me=typeof M=="object"&&M&&M.Object===Object&&M,ye=typeof self=="object"&&self&&self.Object===Object&&self,be=me||ye||Function("return this")(),pe=Object.prototype,he=pe.toString,ve=Math.max,ke=Math.min,q=function(){return be.Date.now()};function Le(e,t,o){var r,n,a,s,i,c,f=0,p=!1,u=!1,y=!0;if(typeof e!="function")throw new TypeError(U);t=z(t)||0,H(o)&&(p=!!o.leading,u="maxWait"in o,a=u?ve(z(o.maxWait)||0,t):a,y="trailing"in o?!!o.trailing:y);function h(l){var m=r,v=n;return r=n=void 0,f=l,s=e.apply(v,m),s}function g(l){return f=l,i=setTimeout($,t),p?h(l):s}function b(l){var m=l-c,v=l-f,N=t-m;return u?ke(N,a-v):N}function I(l){var m=l-c,v=l-f;return c===void 0||m>=t||m<0||u&&v>=a}function $(){var l=q();if(I(l))return w(l);i=setTimeout($,b(l))}function w(l){return i=void 0,y&&r?h(l):(r=n=void 0,s)}function Q(){i!==void 0&&clearTimeout(i),f=0,r=c=n=i=void 0}function V(){return i===void 0?s:w(q())}function E(){var l=q(),m=I(l);if(r=arguments,n=this,c=l,m){if(i===void 0)return g(c);if(u)return i=setTimeout($,t),h(c)}return i===void 0&&(i=setTimeout($,t)),s}return E.cancel=Q,E.flush=V,E}function Se(e,t,o){var r=!0,n=!0;if(typeof e!="function")throw new TypeError(U);return H(o)&&(r="leading"in o?!!o.leading:r,n="trailing"in o?!!o.trailing:n),Le(e,t,{leading:r,maxWait:t,trailing:n})}function H(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Te(e){return!!e&&typeof e=="object"}function $e(e){return typeof e=="symbol"||Te(e)&&he.call(e)==se}function z(e){if(typeof e=="number")return e;if($e(e))return F;if(H(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=H(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(ce,"");var o=ge.test(e);return o||fe.test(e)?ue(e.slice(2),o?2:8):de.test(e)?F:+e}var Me=Se;const Ae=Z(Me);function X(){return{seeMoreBtnRef:document.querySelectorAll(".gallery-see-more-btn"),galleryRef:document.querySelector(".gallery"),activeCategory:document.querySelectorAll(".active"),categoriesRef:document.querySelector(".nav-categories-list"),bookInfo:document.querySelector(".container-modal-fav"),modal:document.querySelector("[data-modal]")}}async function D(e){try{ee();const t=await _.get(`https://books-backend.p.goit.global/books/category?category=${e}`);return te(),t.data}catch(t){console.log("catch error",t)}}async function B(){try{oe();const e=await _.get("https://books-backend.p.goit.global/books/top-books");return re(),e.data}catch(e){console.log("catch error",e)}}function P(e){return`  <div class="gallery-book-link" data-id="${e._id}">
              <div class="gallery-book-card">
                <div class="gallery-book-cover" style="background-image: url('${e.book_image}')">
                </div>
                <p class="gallery-book-name">${e.title}</p>
                <p class="gallery-author">${e.author}</p>
              </div>
            </div>`}function C(e){return`  <div class="gallery-book-home-link" data-id="${e._id}">
              <div class="gallery-book-card">
                <div class="gallery-book-cover" style="background-image: url('${e.book_image}')">
                </div>
                <p class="gallery-book-name">${e.title}</p>
                <p class="gallery-author">${e.author}</p>
              </div>
            </div>`}let J,G;function je({book_image:e,title:t,author:o,description:r,buy_links:n,_id:a}){const s=document.querySelector(".modal-fav-book");document.querySelector(".modal-fav");const i=document.querySelector(".btn-wrap");let c=[],f,p,u,y;G=localStorage.getItem("isAuthenticated");try{J=JSON.parse(G)}catch(g){console.log(g)}n.forEach(g=>{if(g.name==="Amazon"){const b=`<a href="${g.url}" target="_blank" rel="noreferrer noopener">
            <img
            // src="${ne}"
            alt="amazon label"
            class="buy-img"
            />
        </a>`;c.push(b)}if(g.name==="Apple Books"){const b=`<a href="${g.url}" target="_blank" rel="noreferrer noopener">
            <img
            src="${ae}"
            alt="apple label"
            class="buy-img"
                />
        </a>`;c.push(b)}if(g.name==="Barnes and Noble"){const b=`<a href="${g.url}" target="_blank" rel="noreferrer noopener">
              <img
                src="${le}"
                alt="apple label"
                class="buy-img"
              />
                </a>`;c.push(b)}}),e!==""?f=`<img class="modal-fav-image" src="${e}" alt="book-cover"/>`:f='<img class="modal-fav-image" src="../images/Logotype.png" alt="book-cover"/>',t!==""?p=`<h1 class="modal-fav-title">${t}</h1>`:p='<h1 class="modal-fav-title">No title</h1>',o!==""?u=`<h2 class="modal-fav-author">${o}</h2>`:u='<h2 class="modal-fav-author">No author name</h2>',r!==""?y=`<p class="modal-fav-descr">${r}</p>`:y='<p class="modal-fav-descr">No description</p>';const h=`${f}
   <div class="book-descr-wrapper">${p}
${u}
${y}
<div class="buy-label">${c.join("")}</div>

</div>`;if(s.innerHTML=h,J)i.innerHTML='<button class="fav-add-book-btn" data-id = ${_id} type="button">add to shopping list</button>';else return}function He(){const e=document.querySelector("[data-modal-close]"),t=document.querySelector("[data-modal]");document.body.classList.add("modal-open"),t.classList.remove("is-hidden"),e.addEventListener("click",o);function o(){document.body.classList.remove("modal-open"),t.classList.add("is-hidden"),t.removeEventListener("click",r),e.removeEventListener("click",o),document.removeEventListener("keydown",n)}t.addEventListener("click",r);function r(a){a.target===a.currentTarget&&o()}document.addEventListener("keydown",n);function n(a){a.code==="Escape"&&o()}}const A=document.querySelector(".add-book-notification");async function Y(e){const t=e.currentTarget.dataset.id,o=await ie(e.currentTarget.dataset.id);je(o);const r=document.querySelector(".fav-add-book-btn");r&&(O(t)==null?(A.classList.add("hidden"),r.textContent="add to shopping list"):(A.classList.remove("hidden"),r.textContent="remove from the shopping list"),r.addEventListener("click",n)),He();function n(){if(O(t)==null)try{k.push(o),localStorage.setItem("books",JSON.stringify(k)),A.classList.remove("hidden"),r.textContent="remove from the shopping list",W.Notify.info("You have added the book to the shopping list.")}catch(a){console.log(a)}else try{A.classList.add("hidden"),r.textContent="add to shopping list";const a=k.findIndex(s=>s._id==t);a!==-1&&(k.splice(a,1),localStorage.setItem("books",JSON.stringify(k)),W.Notify.info("You have removed the book from the shopping list."))}catch(a){console.log(a)}}}function T(){const e=document.querySelectorAll(".gallery-book-home-link"),t=document.querySelectorAll(".gallery-book-link");for(let o=0;o<e.length;o++)e[o].addEventListener("click",Y);for(let o=0;o<t.length;o++)t[o].addEventListener("click",Y)}const{galleryRef:L,categoriesRef:Ee}=X();function j(e){if(L.innerHTML="",e.target.innerHTML==="See more"){L.insertAdjacentHTML("beforeend",`<h2 class="gallery-title">${e.target.dataset.category.trim().split(" ").slice(0,e.target.innerHTML.length-1).join(" ")} <span class = "gellery-title-akcent">${e.target.dataset.category.trim().split(" ").pop()}</span></h2>`),L.insertAdjacentHTML("beforeend",'<div class="gallery-list2"></div>');const r=document.querySelector(".gallery-list2"),n=e.target.dataset.category.split(" ").join("%20");D(n).then(a=>{a.map(s=>{r.insertAdjacentHTML("beforeend",P(s))}),T()}),Ee.querySelector(".active").classList.remove("active"),document.querySelector(`[data-id="${e.target.dataset.category}"]`).classList.add("active"),window.scrollTo(0,0);return}if(e.target.innerHTML.trim()==="All categories"){x(),window.scrollTo(0,0);return}L.insertAdjacentHTML("beforeend",`<h2 class="gallery-title">${e.target.innerHTML.trim().split(" ").slice(0,e.target.innerHTML.length-1).join(" ")} <span class = "gellery-title-akcent">${e.target.innerHTML.trim().split(" ").pop()}</span></h2>`),L.insertAdjacentHTML("beforeend",'<div class="gallery-list2"></div>');const t=document.querySelector(".gallery-list2"),o=e.target.innerHTML.trim().split(" ").join("%20");D(o).then(r=>{r.map(n=>t.insertAdjacentHTML("beforeend",P(n))),T()}),window.scrollTo(0,0)}const{galleryRef:d}=X();function x(){d.innerHTML="",document.documentElement.clientWidth<768?(d.insertAdjacentHTML("beforeend",'<h2 class="gallery-title">Best Sellers <span class="gellery-title-akcent">Books</span></h2>'),B().then(e=>{for(let o of e)d.insertAdjacentHTML("beforeend",`<h3 class="gallery-category">${o.books[0].list_name}</h3>`),d.insertAdjacentHTML("beforeend",C(o.books[0])),d.insertAdjacentHTML("beforeend",`<button class="gallery-see-more-btn" data-category="${o.books[0].list_name}">See more</button>`);const t=document.querySelectorAll(".gallery-see-more-btn");for(let o=0;o<t.length;o++)t[o].addEventListener("click",j);T()})):document.documentElement.clientWidth<1440?(d.insertAdjacentHTML("beforeend",'<h2 class="gallery-title">Best Sellers <span class="gellery-title-akcent">Books</span></h2>'),B().then(e=>{for(let o of e){d.insertAdjacentHTML("beforeend",`<h3 class="gallery-category">${o.books[0].list_name}</h3>
          <div class="gallery-list"></div>`);const r=document.querySelectorAll(".gallery-list"),n=r[r.length-1];for(let a=0;a<3;a++)n.insertAdjacentHTML("beforeend",C(o.books[a]));d.insertAdjacentHTML("beforeend",`<button class="gallery-see-more-btn" data-category="${o.books[0].list_name}">See more</button>`)}const t=document.querySelectorAll(".gallery-see-more-btn");for(let o=0;o<t.length;o++)t[o].addEventListener("click",j);T()})):(d.insertAdjacentHTML("beforeend",'<h2 class="gallery-title">Best Sellers <span class="gellery-title-akcent">Books</span></h2>'),B().then(e=>{for(let r of e){d.insertAdjacentHTML("beforeend",`<h3 class="gallery-category">${r.books[0].list_name}</h3>
          <div class="gallery-list"></div>`);var t=document.querySelectorAll(".gallery-list");const n=t[t.length-1];for(let a=0;a<5;a++)n.insertAdjacentHTML("beforeend",C(r.books[a]));d.insertAdjacentHTML("beforeend",`<button class="gallery-see-more-btn" data-category="${r.books[0].list_name}">See more</button>`)}const o=document.querySelectorAll(".gallery-see-more-btn");for(let r=0;r<o.length;r++)o[r].addEventListener("click",j);T()})),window.scrollTo(0,0)}x();let S=document.documentElement.clientWidth;onresize=Ae(e=>{e.preventDefault();let t=document.documentElement.clientWidth;S<768?t>767&&(R(),S=t):S<1440?(t>1439||t<768)&&(R(),S=t):t<1440&&(R(),S=t)},100);function R(){document.querySelector(".active").innerHTML.trim()==="All categories"&&x()}const K=document.querySelector(".nav-categories-list");async function qe(){const{data:e}=await _.get("https://books-backend.p.goit.global/books/category-list");return e}const Be=async()=>{try{const e=await qe();K.innerHTML=await Re(e),document.querySelectorAll(".nav-category-item").forEach(o=>{o.addEventListener("click",r=>{const n=document.querySelector(".nav-category-item.active");n&&n.classList.remove("active"),r.target.classList.add("active")})})}catch{console.log("Oops! Something went wrong")}};Be();K.addEventListener("click",Ce);function Ce(e){e.target.dataset.id&&j(e)}function Re(e){return`<li class="nav-category-item active" data-id="all-categories">
        All categories</li>
        ${e.map(t=>`<li class="nav-category-item" data-id="${t.list_name}">
        ${t.list_name}
        </li>`).join("")}`}
